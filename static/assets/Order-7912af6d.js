import{e,f as t}from"./executor-c862610e.js";import{a5 as l,c as r,o as a,d,f as s,w as i,t as o,z as u,e as n,i as c,x as _,A as m,q as f,p}from"./index-996b1aff.js";import{P as b}from"./index-e7ada867.js";import{g as y,d as g,s as h,i as w,a as O,c as x,o as v,t as V,b as D}from"./enum-9649b8be.js";import{_ as Q}from"./_plugin-vue_export-helper-1b428a4d.js";const k={class:"order-page"},N={class:"header-bar"},T={class:"table-actions"},I={class:"left-actions"},U={key:0,class:"text-center py-4"},L={key:1};const S=Q({name:"Order",components:{View:l,Pagination:b},data:()=>({list:null,total:0,listLoading:!0,listQuery:{page:1,size:20,position_id:void 0,strategy_id:void 0,order_status:void 0,is_open:void 0,is_fake:!1,market_order_id:void 0,executor_id:void 0,project_id:void 0},dialogVisible:!1,currentOrder:{}}),methods:{async getList(){this.listLoading=!0;try{const{data:t}=await e(this.listQuery);this.list=t.items,this.total=t.total}catch(t){this.$message.error("获取订单列表失败")}this.listLoading=!1},handleFilter(){this.getList()},async handleDetail(e){try{const{data:l}=await t(e.id);this.currentOrder=l,this.dialogVisible=!0}catch(l){this.$message.error("获取订单详情失败")}},formatDate(e){if(!e)return"";const t=new Date(e),l=e=>e.toString().padStart(2,"0");return`${t.getFullYear()}-${l(t.getMonth()+1)}-${l(t.getDate())} ${l(t.getHours())}:${l(t.getMinutes())}:${l(t.getSeconds())}`},formatNumber:(e,t=2)=>null==e?"-":Number(e).toFixed(t).replace(/\.?0+$/,""),tableRowClassName:({row:e})=>e.is_fake?"fake-row":"",getOrderStatusType:y,getOrderStatusText:g,sideZh:h,insTypeZh:w,assetTypeZh:O,assetTypeDesc:x,orderTypeText:v,tradeModeText:V,insTypeDesc:D},created(){this.getList()}},[["render",function(e,t,l,b,y,g){const h=r("el-input"),w=r("el-option"),O=r("el-select"),x=r("el-button"),v=r("el-skeleton"),V=r("el-table-column"),D=r("el-tag"),Q=r("View"),S=r("el-icon"),$=r("el-tooltip"),z=r("el-table"),j=r("el-card"),C=r("pagination"),Z=r("el-descriptions-item"),q=r("el-descriptions"),F=r("el-dialog");return a(),d("div",k,[s(j,{shadow:"hover"},{header:i((()=>[n("div",N,[n("div",T,[n("div",I,[s(h,{modelValue:y.listQuery.position_id,"onUpdate:modelValue":t[0]||(t[0]=e=>y.listQuery.position_id=e),placeholder:"仓位ID",style:{width:"180px"},class:"filter-item"},null,8,["modelValue"]),s(h,{modelValue:y.listQuery.strategy_id,"onUpdate:modelValue":t[1]||(t[1]=e=>y.listQuery.strategy_id=e),placeholder:"策略ID",style:{width:"120px"},class:"filter-item"},null,8,["modelValue"]),s(O,{modelValue:y.listQuery.order_status,"onUpdate:modelValue":t[2]||(t[2]=e=>y.listQuery.order_status=e),placeholder:"订单状态",clearable:"",style:{width:"120px"},class:"filter-item"},{default:i((()=>[s(w,{label:"已创建",value:"created"}),s(w,{label:"已提交",value:"submitted"}),s(w,{label:"部分成交",value:"partially_filled"}),s(w,{label:"全部成交",value:"filled"}),s(w,{label:"已撤单",value:"canceled"}),s(w,{label:"被拒绝",value:"rejected"}),s(w,{label:"过期",value:"expired"}),s(w,{label:"异常",value:"error"})])),_:1},8,["modelValue"]),s(O,{modelValue:y.listQuery.is_open,"onUpdate:modelValue":t[3]||(t[3]=e=>y.listQuery.is_open=e),placeholder:"开/平仓",clearable:"",style:{width:"100px"},class:"filter-item"},{default:i((()=>[s(w,{label:"开仓",value:!0}),s(w,{label:"平仓",value:!1})])),_:1},8,["modelValue"]),s(O,{modelValue:y.listQuery.is_fake,"onUpdate:modelValue":t[4]||(t[4]=e=>y.listQuery.is_fake=e),placeholder:"仓位类型",clearable:"",style:{width:"100px"},class:"filter-item"},{default:i((()=>[s(w,{label:"真仓位",value:!1}),s(w,{label:"虚拟仓位",value:!0})])),_:1},8,["modelValue"]),s(h,{modelValue:y.listQuery.market_order_id,"onUpdate:modelValue":t[5]||(t[5]=e=>y.listQuery.market_order_id=e),placeholder:"市场订单ID",style:{width:"140px"},class:"filter-item"},null,8,["modelValue"]),s(h,{modelValue:y.listQuery.executor_id,"onUpdate:modelValue":t[6]||(t[6]=e=>y.listQuery.executor_id=e),placeholder:"交易器ID",style:{width:"120px"},class:"filter-item"},null,8,["modelValue"]),s(x,{type:"primary",onClick:g.handleFilter,class:"filter-item"},{default:i((()=>t[10]||(t[10]=[c("查询")]))),_:1},8,["onClick"])])])])])),default:i((()=>[y.listLoading?(a(),d("div",U,[s(v,{rows:4,animated:""})])):(a(),d("div",L,[s(z,{data:y.list||[],style:{width:"100%"},size:"small",align:"left",border:"",fit:"","highlight-current-row":"","row-class-name":g.tableRowClassName},{default:i((()=>[s(V,{align:"center",label:"ID"},{default:i((e=>[c(_(e.row.id),1)])),_:1}),s(V,{label:"策略ID"},{default:i((e=>[c(_(e.row.strategy_name),1)])),_:1}),s(V,{label:"交易器"},{default:i((e=>[c(_(e.row.exec_name||e.row.executor_id),1)])),_:1}),s(V,{label:"订单状态"},{default:i((e=>[s(D,{type:g.getOrderStatusType(e.row.order_status)},{default:i((()=>[c(_(g.getOrderStatusText(e.row.order_status)),1)])),_:2},1032,["type"])])),_:1}),s(V,{label:"交易标的"},{default:i((e=>[c(_(e.row.symbol)+" - "+_(e.row.quote_currency),1)])),_:1}),s(V,{label:"方向",align:"center"},{default:i((e=>[s(D,{type:"1"===e.row.side?"success":"danger"},{default:i((()=>[c(_(g.sideZh(e.row.side)),1)])),_:2},1032,["type"]),s(D,{type:e.row.is_open?"success":"info"},{default:i((()=>[c(_(e.row.is_open?"开仓":"平仓"),1)])),_:2},1032,["type"])])),_:1}),s(V,{label:"订单金额",align:"right"},{default:i((e=>[c(_(g.formatNumber(e.row.settle_amount||e.row.order_amount,4)),1)])),_:1}),s(V,{label:"价格",align:"right"},{default:i((e=>[c(_(g.formatNumber(e.row.order_price||e.row.execution_price,8)),1)])),_:1}),s(V,{label:"手续费",align:"right"},{default:i((e=>[c(_(g.formatNumber(e.row.fee,4)),1)])),_:1}),s(V,{label:"盈亏",align:"right"},{default:i((e=>[n("span",{class:m(e.row.pnl>=0?"text-success":"text-danger")},_(e.row.pnl>0?"+":"")+_(g.formatNumber(e.row.pnl,12)),3)])),_:1}),s(V,{label:"订单时间",align:"center"},{default:i((e=>[c(_(g.formatDate(e.row.order_time)),1)])),_:1}),s(V,{label:"操作",align:"center"},{default:i((e=>[s($,{content:"查看详情",placement:"top"},{default:i((()=>[s(x,{size:"small",onClick:t=>g.handleDetail(e.row),circle:""},{default:i((()=>[s(S,null,{default:i((()=>[s(Q)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","row-class-name"])]))])),_:1}),o(s(C,{total:y.total,page:y.listQuery.page,"onUpdate:page":t[7]||(t[7]=e=>y.listQuery.page=e),limit:y.listQuery.size,"onUpdate:limit":t[8]||(t[8]=e=>y.listQuery.size=e),onPagination:g.getList},null,8,["total","page","limit","onPagination"]),[[u,y.total>0]]),s(F,{modelValue:y.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>y.dialogVisible=e),title:"订单详情",width:"800px"},{default:i((()=>[s(q,{column:2,border:""},{default:i((()=>[s(Z,{label:"订单ID"},{default:i((()=>[c(_(y.currentOrder.id),1)])),_:1}),s(Z,{label:"策略"},{default:i((()=>[c(_(y.currentOrder.strategy_name),1)])),_:1}),s(Z,{label:"信号ID"},{default:i((()=>[c(_(y.currentOrder.signal_id),1)])),_:1}),s(Z,{label:"仓位ID"},{default:i((()=>[c(_(y.currentOrder.position_id),1)])),_:1}),s(Z,{label:"执行订单ID"},{default:i((()=>[c(_(y.currentOrder.exec_order_id),1)])),_:1}),s(Z,{label:"执行器"},{default:i((()=>[c(_(y.currentOrder.exec_name),1)])),_:1}),s(Z,{label:"订单状态"},{default:i((()=>[s(D,{type:g.getOrderStatusType(y.currentOrder.order_status)},{default:i((()=>[c(_(g.getOrderStatusText(y.currentOrder.order_status)),1)])),_:1},8,["type"])])),_:1}),s(Z,{label:"交易标的"},{default:i((()=>[s(D,{type:"info",class:"ml-2"},{default:i((()=>[c(_(g.assetTypeDesc(y.currentOrder.asset_type)),1)])),_:1}),c(" "+_(y.currentOrder.symbol)+" - "+_(y.currentOrder.quote_currency),1)])),_:1}),s(Z,{label:"交易品种"},{default:i((()=>[s(D,null,{default:i((()=>[c(_(g.insTypeDesc(y.currentOrder.ins_type)),1)])),_:1})])),_:1}),s(Z,{label:"交易方向"},{default:i((()=>[s(D,{type:"LONG"===y.currentOrder.side?"success":"danger"},{default:i((()=>[c(_(g.sideZh(y.currentOrder.side)),1)])),_:1},8,["type"]),s(D,{type:y.currentOrder.is_open?"success":"info",class:"ml-2"},{default:i((()=>[c(_(y.currentOrder.is_open?"开仓":"平仓"),1)])),_:1},8,["type"]),y.currentOrder.is_fake?(a(),f(D,{key:0,type:"warning",class:"ml-2"},{default:i((()=>t[11]||(t[11]=[c("虚拟")]))),_:1})):p("",!0)])),_:1}),s(Z,{label:"订单金额"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.order_amount,4)),1)])),_:1}),s(Z,{label:"成交金额"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.settle_amount,4)),1)])),_:1}),s(Z,{label:"订单价格"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.order_price,12)),1)])),_:1}),s(Z,{label:"成交均价"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.execution_price,12)),1)])),_:1}),s(Z,{label:"手续费"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.fee,8)),1)])),_:1}),s(Z,{label:"盈亏"},{default:i((()=>[n("span",{class:m(y.currentOrder.pnl>=0?"text-success":"text-danger")},_(g.formatNumber(y.currentOrder.pnl,4)),3)])),_:1}),s(Z,{label:"杠杆"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.leverage,2))+"x",1)])),_:1}),s(Z,{label:"订单数量"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.sz*y.currentOrder.sz_value,4)),1)])),_:1}),s(Z,{label:"交易模式"},{default:i((()=>[c(_(g.tradeModeText(y.currentOrder.trade_mode)),1)])),_:1}),s(Z,{label:"摩擦成本"},{default:i((()=>[c(_(g.formatNumber(y.currentOrder.friction,4)),1)])),_:1}),s(Z,{label:"是否虚拟"},{default:i((()=>[c(_(y.currentOrder.is_fake?"是":"否"),1)])),_:1}),s(Z,{label:"订单时间"},{default:i((()=>[c(_(g.formatDate(y.currentOrder.order_time)),1)])),_:1}),s(Z,{label:"完成时间"},{default:i((()=>[c(_(g.formatDate(y.currentOrder.finish_time)),1)])),_:1}),s(Z,{label:"订单类型"},{default:i((()=>[c(_(g.orderTypeText(y.currentOrder.order_type)),1)])),_:1}),s(Z,{label:"市场订单ID"},{default:i((()=>[c(_(y.currentOrder.market_order_id),1)])),_:1}),s(Z,{label:"更新时间"},{default:i((()=>[c(_(g.formatDate(y.currentOrder.updated_at)),1)])),_:1}),s(Z,{label:"扩展信息",span:2},{default:i((()=>[c(_(y.currentOrder.extra||"-"),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])])}],["__scopeId","data-v-b2e28e9b"]]);export{S as default};
