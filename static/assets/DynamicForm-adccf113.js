import{r as e,M as a,c as l,o as r,d as t,e as o,F as d,O as n,n as i,y as s,s as u,i as m,x as c,q as y,w as p,p as f,t as h,a7 as A,v as b,a8 as v,a9 as V}from"./index-996b1aff.js";import{_ as g}from"./_plugin-vue_export-helper-1b428a4d.js";const x={class:"dynamic-form"},k={class:"form-row"},D=["for"],q={key:1,class:"required"},U={class:"col-input"},w=["type","id","onUpdate:modelValue","required","min","max","maxlength","onInput"],_=["id","onUpdate:modelValue","required","maxlength"],I=["id","onUpdate:modelValue","required","min","max"],$={key:5,class:"radio-group"},S=["id","name","value","onUpdate:modelValue","required","disabled"],j=["for"];const C=g({name:"DynamicForm",props:{fields:{type:Array,required:!0},modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(l,{emit:r}){function t(){const e={};return l.fields.forEach((a=>{if(("select"===a.type||"radio"===a.type)&&a.required&&Array.isArray(a.choices)&&1===a.choices.length){const l=Array.isArray(a.choices[0])?a.choices[0][0]:a.choices[0];"select"===a.type?e[a.name]=[l]:e[a.name]=l}else"select"===a.type?Array.isArray(l.modelValue[a.name])?e[a.name]=l.modelValue[a.name]:void 0!==a.default&&null!==a.default?e[a.name]=Array.isArray(a.default)?a.default:[a.default]:e[a.name]=[]:"array"===a.type?e[a.name]=Array.isArray(l.modelValue[a.name])?l.modelValue[a.name]:void 0!==a.default?a.default:[]:e[a.name]=void 0!==l.modelValue[a.name]?l.modelValue[a.name]:void 0!==a.default?a.default:""})),e}const o=e(t());a((()=>l.fields),(()=>{o.value=t(),r("update:modelValue",{...o.value})}),{immediate:!0,deep:!0}),a((()=>l.modelValue),(e=>{e&&"object"==typeof e&&Object.keys(e).forEach((a=>{o.value[a]=e[a]}))})),a(o,(e=>{r("update:modelValue",{...e})}),{deep:!0});return{formData:o,handleSubmit:()=>{},addArrayItem:e=>{o.value[e]||(o.value[e]=[]),o.value[e].push("")},removeArrayItem:(e,a)=>{o.value[e].splice(a,1)},getArrayProxy:e=>s({get(){const a=Array.isArray(o.value[e])?o.value[e]:[];return Array.from(new Set(a.filter((e=>!!e&&""!==e.trim()))))},set(a){o.value[e]=Array.from(new Set(a.filter((e=>!!e&&""!==e.trim()))))}}),handleArrayInputChange:e=>{u((()=>{const a=V();if(a&&a.proxy&&a.proxy.$refs){const l=a.proxy.$refs[`arrayRef-${e}`];l&&void 0!==l.inputValue&&(l.inputValue="")}}))},handleFloatInput:function(e,a,l){if("float"===l){let l=e.target.value;if(""===l||/^-?(\\d+)?(\\.\\d*)?$/.test(l));else{l=l.replace(/[^0-9\.\-]/g,""),l=l.startsWith("-")?"-"+l.slice(1).replace(/-/g,""):l.replace(/-/g,"");const e=l.indexOf(".");-1!==e&&(l=l.substring(0,e+1)+l.substring(e+1).replace(/\./g,"")),o.value[a]=l}}},shouldDisable:function(e){return("select"===e.type||"radio"===e.type)&&e.required&&Array.isArray(e.choices)&&1===e.choices.length},chunk:function(e,a){const l=[];for(let r=0;r<e.length;r+=a)l.push(e.slice(r,r+a));return l}}}},[["render",function(e,a,s,u,V,g){const C=l("el-tooltip"),F=l("el-switch"),O=l("el-option"),P=l("el-select"),E=l("el-checkbox"),R=l("el-checkbox-group");return r(),t("div",x,[o("form",{onSubmit:a[0]||(a[0]=i(((...e)=>u.handleSubmit&&u.handleSubmit(...e)),["prevent"]))},[(r(!0),t(d,null,n(s.fields,(e=>(r(),t("div",{key:e.name,class:"form-group row"},[o("div",k,[o("label",{for:e.name,class:"form-label col-label"},[m(c(e.label||e.name)+" ",1),e.description?(r(),y(C,{key:0,content:e.description,placement:"top"},{default:p((()=>a[1]||(a[1]=[o("span",{class:"desc-tip"},"?",-1)]))),_:2},1032,["content"])):f("",!0),e.required?(r(),t("span",q,"*")):f("",!0)],8,D),o("div",U,[["string","int","float"].includes(e.type)?h((r(),t("input",{key:0,type:"int"===e.type?"number":"text",id:e.name,"onUpdate:modelValue":a=>u.formData[e.name]=a,required:e.required,min:e.min,max:e.max,maxlength:e.length,class:"form-control",onInput:a=>u.handleFloatInput(a,e.name,e.type)},null,40,w)),[[A,u.formData[e.name]]]):"password"===e.type?h((r(),t("input",{key:1,type:"password",id:e.name,"onUpdate:modelValue":a=>u.formData[e.name]=a,required:e.required,maxlength:e.length,class:"form-control"},null,8,_)),[[b,u.formData[e.name]]]):"bool"===e.type?(r(),y(F,{key:2,id:e.name,modelValue:u.formData[e.name],"onUpdate:modelValue":a=>u.formData[e.name]=a,required:e.required},null,8,["id","modelValue","onUpdate:modelValue","required"])):"datetime"===e.type?h((r(),t("input",{key:3,type:"datetime-local",id:e.name,"onUpdate:modelValue":a=>u.formData[e.name]=a,required:e.required,min:e.min,max:e.max,class:"form-control"},null,8,I)),[[b,u.formData[e.name]]]):"radio"===e.type&&e.choices&&e.choices.length>16?(r(),y(P,{key:4,modelValue:u.formData[e.name],"onUpdate:modelValue":a=>u.formData[e.name]=a,filterable:"",placeholder:e.placeholder||"请选择",style:{width:"100%"},disabled:u.shouldDisable(e)},{default:p((()=>[(r(!0),t(d,null,n(e.choices,(e=>(r(),y(O,{key:Array.isArray(e)?e[0]:e,label:Array.isArray(e)?e[1]:e,value:Array.isArray(e)?e[0]:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])):"radio"===e.type?(r(),t("div",$,[(r(!0),t(d,null,n(e.choices,(a=>(r(),t("div",{key:Array.isArray(a)?a[0]:a,class:"form-check"},[h(o("input",{type:"radio",id:`${e.name}-${Array.isArray(a)?a[0]:a}`,name:e.name,value:Array.isArray(a)?a[0]:a,"onUpdate:modelValue":a=>u.formData[e.name]=a,required:e.required,class:"form-check-input",disabled:u.shouldDisable(e)},null,8,S),[[v,u.formData[e.name]]]),o("label",{for:`${e.name}-${Array.isArray(a)?a[0]:a}`,class:"form-check-label"},c(Array.isArray(a)?a[1]:a),9,j)])))),128))])):"select"===e.type&&e.choices&&e.choices.length>16?(r(),y(P,{key:6,modelValue:u.formData[e.name],"onUpdate:modelValue":a=>u.formData[e.name]=a,multiple:"",filterable:"",placeholder:e.placeholder||"请选择",style:{width:"100%"},disabled:u.shouldDisable(e)},{default:p((()=>[(r(!0),t(d,null,n(e.choices,(e=>(r(),y(O,{key:Array.isArray(e)?e[0]:e,label:Array.isArray(e)?e[1]:e,value:Array.isArray(e)?e[0]:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])):"select"===e.type?(r(),y(R,{key:7,modelValue:u.formData[e.name],"onUpdate:modelValue":a=>u.formData[e.name]=a,class:"checkbox-multicol",disabled:u.shouldDisable(e)},{default:p((()=>[(r(!0),t(d,null,n(e.choices,(a=>(r(),y(E,{key:Array.isArray(a)?a[0]:a,value:Array.isArray(a)?a[0]:a,disabled:u.shouldDisable(e)},{default:p((()=>[m(c(Array.isArray(a)?a[1]:a),1)])),_:2},1032,["value","disabled"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"array"===e.type?(r(),y(P,{key:8,modelValue:u.getArrayProxy(e.name).value,"onUpdate:modelValue":a=>u.getArrayProxy(e.name).value=a,multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:e.placeholder||"请输入并回车添加",ref_for:!0,ref:`arrayRef-${e.name}`,style:{width:"100%"},onChange:()=>u.handleArrayInputChange(e.name)},{default:p((()=>[(r(!0),t(d,null,n(u.getArrayProxy(e.name).value,(e=>(r(),y(O,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])):f("",!0)])])])))),128))],32)])}],["__scopeId","data-v-6d65bbe3"]]);export{C as D};
