import{L as e,aa as t,c as a,o as s,d as l,f as i,w as r,e as n,F as o,O as d,i as g,x as c,t as y,z as m,q as p,p as u}from"./index-996b1aff.js";import{a as h,h as f}from"./strategy-757b8677.js";import{P as _}from"./index-e7ada867.js";import{f as b,a as w,i as v,s as k,e as x}from"./enum-9649b8be.js";import{_ as S}from"./_plugin-vue_export-helper-1b428a4d.js";const T={class:"strategy-signal-page"},z={class:"header-bar"},Q={class:"table-actions"},$={class:"left-actions"},j={class:"right-actions"},L={key:0,class:"text-center py-4"},O={key:1},C={key:0},F={key:1,class:"text-muted"},V={key:0,class:"text-muted"},Z={key:0,class:"text-muted"};const D=S({name:"StrategySignal",components:{Pagination:_,Search:t},data:()=>({list:null,total:0,listLoading:!0,listQuery:{page:1,size:20,strategy_instance_id:void 0,strategy_class_name:void 0},strategyOptions:[],strategyTemplates:[]}),created(){this.getList(),this.getStrategies(),this.getStrategyTemplates()},methods:{async getList(){this.listLoading=!0;try{const{data:a}=await(t=this.listQuery,e.get("/signals",{params:t}));this.list=a,this.total=a.length}catch(a){this.$message.error("获取信号列表失败")}var t;this.listLoading=!1},async getStrategies(){try{const{data:e}=await h();this.strategyOptions=e}catch(e){this.$message.error("获取策略列表失败")}},async getStrategyTemplates(){try{const{data:e}=await f();this.strategyTemplates=e}catch(e){this.$message.error("获取策略模板失败")}},handleFilter(){this.listQuery.page=1,this.getList()},formatDate(e){if(!e)return"";const t=new Date(e),a=e=>e.toString().padStart(2,"0");return`${t.getFullYear()}-${a(t.getMonth()+1)}-${a(t.getDate())} ${a(t.getHours())}:${a(t.getMinutes())}:${a(t.getSeconds())}`},getAssetTypeTag:b,assetTypeZh:w,insTypeZh:v,sideZh:k,getPositionSideTag:x}},[["render",function(e,t,h,f,_,b){const w=a("el-option"),v=a("el-select"),k=a("Search"),x=a("el-icon"),S=a("el-button"),D=a("el-skeleton"),P=a("el-table-column"),U=a("el-tag"),A=a("el-table"),q=a("pagination"),I=a("el-card");return s(),l("div",T,[i(I,{shadow:"hover"},{header:r((()=>[n("div",z,[n("div",Q,[n("div",$,[i(v,{modelValue:_.listQuery.strategy_instance_id,"onUpdate:modelValue":t[0]||(t[0]=e=>_.listQuery.strategy_instance_id=e),placeholder:"选择策略",clearable:"",filterable:"",style:{width:"200px"},class:"filter-item",onChange:b.handleFilter},{default:r((()=>[(s(!0),l(o,null,d(_.strategyOptions,(e=>(s(),p(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),i(v,{modelValue:_.listQuery.strategy_class_name,"onUpdate:modelValue":t[1]||(t[1]=e=>_.listQuery.strategy_class_name=e),placeholder:"选择策略模板",clearable:"",filterable:"",style:{width:"200px"},class:"filter-item",onChange:b.handleFilter},{default:r((()=>[(s(!0),l(o,null,d(_.strategyTemplates,(e=>(s(),p(w,{key:e.cls,label:e.name,value:e.cls},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])]),n("div",j,[i(S,{type:"primary",onClick:b.handleFilter,class:"filter-item"},{default:r((()=>[i(x,null,{default:r((()=>[i(k)])),_:1}),t[4]||(t[4]=g(" 搜索 "))])),_:1},8,["onClick"])])])])])),default:r((()=>[_.listLoading?(s(),l("div",L,[i(D,{rows:4,animated:""})])):(s(),l("div",O,[i(A,{data:_.list||[],style:{width:"100%"},size:"small",border:"",fit:"","highlight-current-row":""},{default:r((()=>[i(P,{align:"center",label:"信号ID",width:"160"},{default:r((e=>[g(c(e.row.id),1)])),_:1}),i(P,{label:"策略"},{default:r((e=>[g(c(e.row.strategy_name),1)])),_:1}),i(P,{label:"资产信息","min-width":240},{default:r((e=>[Array.isArray(e.row.assets)&&e.row.assets.length?(s(),l("div",C,[(s(!0),l(o,null,d(e.row.assets,((e,t)=>(s(),l("div",{key:t,style:{"margin-bottom":"2px"}},[i(U,{size:"small",type:"info",class:"mr-1"},{default:r((()=>[g(c(b.assetTypeZh(e.asset_type))+"|"+c(e.symbol)+"_"+c(e.quote_currency)+"|"+c(b.insTypeZh(e.ins_type)),1)])),_:2},1024),i(U,{size:"small",type:"success",class:"mr-2"},{default:r((()=>[g(c(b.sideZh(e.side))+", "+c(e.ratio),1)])),_:2},1024),i(U,{size:"small",type:"warning",class:"mr-1"},{default:r((()=>[g(c(e.price),1)])),_:2},1024),e.extra&&Object.keys(e.extra).length?(s(),p(U,{key:0,size:"small",type:"info",effect:"plain",class:"mr-1"},{default:r((()=>[g(c(Object.entries(e.extra).map((([e,t])=>`${e}: ${t}`)).join(", ")),1)])),_:2},1024)):u("",!0)])))),128))])):(s(),l("span",F,"--"))])),_:1}),i(P,{label:"仓位配置"},{default:r((e=>[e.row.position_config?(s(!0),l(o,{key:1},d(e.row.position_config,((e,t)=>(s(),p(U,{key:t,size:"small",type:"info",effect:"plain",class:"mr-1"},{default:r((()=>[g(c(t)+": "+c(e),1)])),_:2},1024)))),128)):(s(),l("span",V,"--"))])),_:1}),i(P,{label:"扩展信息"},{default:r((e=>[e.row.extra&&0!==Object.keys(e.row.extra).length?(s(!0),l(o,{key:1},d(e.row.extra,((e,t)=>(s(),p(U,{key:t,size:"small",type:"info",effect:"plain",class:"mr-1"},{default:r((()=>[g(c(t)+": "+c(e),1)])),_:2},1024)))),128)):(s(),l("span",Z,"--"))])),_:1}),i(P,{label:"信号时间"},{default:r((e=>[g(c(b.formatDate(e.row.signal_time)),1)])),_:1})])),_:1},8,["data"])])),y(i(q,{total:_.total,page:_.listQuery.page,"onUpdate:page":t[2]||(t[2]=e=>_.listQuery.page=e),limit:_.listQuery.size,"onUpdate:limit":t[3]||(t[3]=e=>_.listQuery.size=e),onPagination:b.getList},null,8,["total","page","limit","onPagination"]),[[m,_.total>0]])])),_:1})])}],["__scopeId","data-v-333237f0"]]);export{D as default};
