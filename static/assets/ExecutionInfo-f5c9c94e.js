import{b as e}from"./executor-c862610e.js";import{a5 as t,c as a,o as l,d as i,f as s,w as r,t as o,z as d,e as n,i as u,x as p,A as _,F as f}from"./index-996b1aff.js";import{P as m}from"./index-e7ada867.js";import{a as c}from"./format-76ff4d5a.js";import{s as b,i as g,a as y,o as w,t as h,b as x,c as D}from"./enum-9649b8be.js";import{_ as N}from"./_plugin-vue_export-helper-1b428a4d.js";const v={class:"execution-info-page"},z={class:"header-bar"},T={class:"table-actions"},V={class:"left-actions"},k={key:0,class:"text-center py-4"},I={key:1},Q={class:"text-end"};const L=N({name:"ExecutionInfo",components:{View:t,Pagination:m},data:()=>({list:null,total:0,listLoading:!0,listQuery:{page:1,size:20,signal_id:void 0,strategy_id:void 0,project_id:void 0},detailDialogVisible:!1,detail:{}}),methods:{formatNumber:c,async getList(){this.listLoading=!0;try{const{data:t}=await e(this.listQuery);this.list=t.items,this.total=t.total}catch(t){this.$message.error("获取执行信息列表失败")}this.listLoading=!1},handleFilter(){this.getList()},handleDetail(e){this.detail=e,this.detailDialogVisible=!0},formatDate(e){if(!e)return"";const t=new Date(e),a=e=>e.toString().padStart(2,"0");return`${t.getFullYear()}-${a(t.getMonth()+1)}-${a(t.getDate())} ${a(t.getHours())}:${a(t.getMinutes())}:${a(t.getSeconds())}`},sideZh:b,insTypeZh:g,assetTypeZh:y,orderTypeText:w,tradeModeText:h,insTypeDesc:x,assetTypeDesc:D},created(){this.getList()}},[["render",function(e,t,m,c,b,g){const y=a("el-input"),w=a("el-button"),h=a("el-skeleton"),x=a("el-table-column"),D=a("el-tag"),N=a("View"),L=a("el-icon"),j=a("el-tooltip"),$=a("el-table"),C=a("el-card"),M=a("pagination"),U=a("el-descriptions-item"),F=a("el-descriptions"),P=a("el-dialog");return l(),i("div",v,[s(C,{shadow:"hover"},{header:r((()=>[n("div",z,[n("div",T,[n("div",V,[s(y,{modelValue:b.listQuery.signal_id,"onUpdate:modelValue":t[0]||(t[0]=e=>b.listQuery.signal_id=e),placeholder:"信号ID",style:{width:"180px"},class:"filter-item"},null,8,["modelValue"]),s(y,{modelValue:b.listQuery.strategy_id,"onUpdate:modelValue":t[1]||(t[1]=e=>b.listQuery.strategy_id=e),placeholder:"策略ID",style:{width:"120px"},class:"filter-item"},null,8,["modelValue"]),s(w,{type:"primary",onClick:g.handleFilter,class:"filter-item"},{default:r((()=>t[6]||(t[6]=[u("查询")]))),_:1},8,["onClick"])])])])])),default:r((()=>[b.listLoading?(l(),i("div",k,[s(h,{rows:4,animated:""})])):(l(),i("div",I,[s($,{data:b.list||[],style:{width:"100%"},size:"default",border:"",fit:"","highlight-current-row":""},{default:r((()=>[s(x,{align:"center",label:"ID"},{default:r((e=>[u(p(e.row.id),1)])),_:1}),s(x,{label:"信号ID"},{default:r((e=>[u(p(e.row.signal_id),1)])),_:1}),s(x,{label:"策略ID"},{default:r((e=>[u(p(e.row.strategy_name),1)])),_:1}),s(x,{label:"开仓金额",align:"right"},{default:r((e=>[u(p(0==e.row.open_amount?"-":g.formatNumber(e.row.open_amount,4)),1)])),_:1}),s(x,{label:"开仓比例",align:"right"},{default:r((e=>[u(p(0==e.row.open_ratio?"-":g.formatNumber(100*e.row.open_ratio,1)+"%"),1)])),_:1}),s(x,{label:"实际比例",align:"right"},{default:r((e=>[u(p(null==e.row.actual_ratio?"-":g.formatNumber(100*e.row.actual_ratio,1)+"%"),1)])),_:1}),s(x,{label:"实际金额",align:"right"},{default:r((e=>[u(p(g.formatNumber(e.row.actual_amount,4)),1)])),_:1}),s(x,{label:"订单类型"},{default:r((e=>[s(D,{type:1===e.row.order_type?"success":"info","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.orderTypeText(e.row.order_type)),1)])),_:2},1032,["type"])])),_:1}),s(x,{label:"交易模式"},{default:r((e=>[s(D,{type:"isolated"===e.row.trade_mode?"warning":"info","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.tradeModeText(e.row.trade_mode)),1)])),_:2},1032,["type"])])),_:1}),s(x,{label:"实际盈亏"},{default:r((e=>[null!==e.row.actual_pnl&&void 0!==e.row.actual_pnl?(l(),i("span",{key:0,class:_(e.row.actual_pnl>=0?"text-success":"text-danger")},p(e.row.actual_pnl>0?"+":"")+p(g.formatNumber(e.row.actual_pnl,12)),3)):(l(),i(f,{key:1},[u(" - ")],64))])),_:1}),s(x,{label:"创建时间"},{default:r((e=>[u(p(g.formatDate(e.row.created_time)),1)])),_:1}),s(x,{label:"操作",align:"center"},{default:r((e=>[s(j,{content:"查看详情",placement:"top"},{default:r((()=>[s(w,{size:"small",onClick:t=>g.handleDetail(e.row),circle:""},{default:r((()=>[s(L,null,{default:r((()=>[s(N)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])]))])),_:1}),o(s(M,{total:b.total,page:b.listQuery.page,"onUpdate:page":t[2]||(t[2]=e=>b.listQuery.page=e),limit:b.listQuery.size,"onUpdate:limit":t[3]||(t[3]=e=>b.listQuery.size=e),onPagination:g.getList},null,8,["total","page","limit","onPagination"]),[[d,b.total>0]]),s(P,{title:"执行详情",modelValue:b.detailDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>b.detailDialogVisible=e),width:"1000px"},{footer:r((()=>[n("div",Q,[s(w,{onClick:t[4]||(t[4]=e=>b.detailDialogVisible=!1)},{default:r((()=>t[7]||(t[7]=[u("关闭")]))),_:1})])])),default:r((()=>[s(F,{column:2,border:""},{default:r((()=>[s(U,{label:"ID"},{default:r((()=>[u(p(b.detail.id),1)])),_:1}),s(U,{label:"信号ID"},{default:r((()=>[u(p(b.detail.signal_id),1)])),_:1}),s(U,{label:"策略"},{default:r((()=>[u(p(b.detail.strategy_name)+" ("+p(b.detail.strategy_id)+" @ "+p(b.detail.strategy_instant_id)+")",1)])),_:1}),s(U,{label:"目标执行器ID"},{default:r((()=>[u(p(b.detail.target_executor_id),1)])),_:1}),s(U,{label:"开仓金额"},{default:r((()=>[u(p(g.formatNumber(b.detail.open_amount,4)),1)])),_:1}),s(U,{label:"开仓比例"},{default:r((()=>[u(p(g.formatNumber(100*b.detail.open_ratio,1))+"%",1)])),_:1}),s(U,{label:"实际比例"},{default:r((()=>[u(p(null==b.detail.actual_ratio?"-":g.formatNumber(100*b.detail.actual_ratio,1)+"%"),1)])),_:1}),s(U,{label:"实际金额"},{default:r((()=>[u(p(g.formatNumber(b.detail.actual_amount,4)),1)])),_:1}),s(U,{label:"实际盈亏"},{default:r((e=>[null!==b.detail.actual_pnl&&void 0!==b.detail.actual_pnl?(l(),i("span",{key:0,class:_(b.detail.actual_pnl>=0?"text-success":"text-danger")},p(b.detail.actual_pnl>0?"+":"")+p(g.formatNumber(b.detail.actual_pnl,12)),3)):(l(),i(f,{key:1},[u(" - ")],64))])),_:1}),s(U,{label:"杠杆"},{default:r((()=>[u(p(g.formatNumber(b.detail.leverage,2))+"x",1)])),_:1}),s(U,{label:"订单类型"},{default:r((()=>[s(D,{type:1===b.detail.order_type?"success":"info","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.orderTypeText(b.detail.order_type)),1)])),_:1},8,["type"])])),_:1}),s(U,{label:"交易品种类型"},{default:r((()=>[s(D,{type:3===b.detail.trade_type?"warning":"success","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.insTypeDesc(b.detail.trade_type)),1)])),_:1},8,["type"])])),_:1}),s(U,{label:"交易模式"},{default:r((()=>[s(D,{type:"isolated"===b.detail.trade_mode?"warning":"info","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.tradeModeText(b.detail.trade_mode)),1)])),_:1},8,["type"])])),_:1}),s(U,{label:"创建时间"},{default:r((()=>[u(p(g.formatDate(b.detail.created_time)),1)])),_:1}),s(U,{label:"扩展信息",span:2},{default:r((()=>[u(p(b.detail.extra?JSON.stringify(b.detail.extra,null,2):"-"),1)])),_:1}),s(U,{label:"执行资产列表",span:2},{default:r((()=>[s($,{data:b.detail.execution_assets,border:"",style:{width:"100%"}},{default:r((()=>[s(x,{prop:"asset_type",label:"交易标的"},{default:r((e=>[u(p(e.row.symbol)+"-"+p(e.row.quote_currency),1)])),_:1}),s(x,{prop:"side",label:"方向"},{default:r((e=>[s(D,{type:"多"===e.row.side?"success":"danger","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.sideZh(e.row.side)),1)])),_:2},1032,["type"])])),_:1}),s(x,{prop:"asset_type",label:"资产类型"},{default:r((e=>[s(D,{type:"加密货币"===e.row.asset_type?"success":"info","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.assetTypeDesc(e.row.asset_type)),1)])),_:2},1032,["type"])])),_:1}),s(x,{prop:"ins_type",label:"交易品种"},{default:r((e=>[s(D,{type:"合约"===e.row.ins_type?"info":"success","disable-transitions":"",size:"small"},{default:r((()=>[u(p(g.insTypeDesc(e.row.ins_type)),1)])),_:2},1032,["type"])])),_:1}),s(x,{prop:"price",label:"价格",align:"right"},{default:r((e=>[u(p(g.formatNumber(e.row.price,18)),1)])),_:1}),s(x,{prop:"amount",label:"金额",align:"right"},{default:r((e=>[u(p(g.formatNumber(e.row.amount,4)||"-"),1)])),_:1}),s(x,{prop:"sz",label:"数量",align:"right"},{default:r((e=>[u(p(g.formatNumber(e.row.sz,4)||"-"),1)])),_:1}),s(x,{prop:"ratio",label:"比例",align:"right"},{default:r((e=>[u(p(g.formatNumber(100*e.row.ratio,1))+"% ",1)])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}],["__scopeId","data-v-7da48805"]]);export{L as default};
